<!DOCTYPE HTML>
<html lang="en" class="sidebar-visible no-js ayu">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Escalating privileges - Introduction to the Dark Arts</title>
        <!-- Custom HTML head -->
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff" />

        <link rel="icon" href="../favicon.svg">
        <link rel="shortcut icon" href="../favicon.png">
        <link rel="stylesheet" href="../css/variables.css">
        <link rel="stylesheet" href="../css/general.css">
        <link rel="stylesheet" href="../css/chrome.css">
        <link rel="stylesheet" href="../css/print.css" media="print">
        <!-- Fonts -->
        <link rel="stylesheet" href="../FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="../fonts/fonts.css">
        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="../highlight.css">
        <link rel="stylesheet" href="../tomorrow-night.css">
        <link rel="stylesheet" href="../ayu-highlight.css">

        <!-- Custom theme stylesheets -->
    </head>
    <body>
        <!-- Provide site root to javascript -->
        <script type="text/javascript">
            var path_to_root = "../";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "ayu";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script type="text/javascript">
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script type="text/javascript">
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('no-js')
            html.classList.remove('ayu')
            html.classList.add(theme);
            html.classList.add('js');
        </script>

        <!-- Hide / unhide sidebar before it is displayed -->
        <script type="text/javascript">
            var html = document.querySelector('html');
            var sidebar = 'hidden';
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            }
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item expanded affix "><a href="../introduction.html">Introduction</a></li><li class="chapter-item expanded "><a href="../reverse-engineering/reverse-engineering.html"><strong aria-hidden="true">1.</strong> Reverse engineering</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../reverse-engineering/static-reverse-engineering.html"><strong aria-hidden="true">1.1.</strong> Static reverse engineering</a></li><li class="chapter-item expanded "><a href="../reverse-engineering/dynamic-reverse-engineering.html"><strong aria-hidden="true">1.2.</strong> Dynamic reverse engineering</a></li><li class="chapter-item expanded "><a href="../reverse-engineering/dumb-fuzzing.html"><strong aria-hidden="true">1.3.</strong> Dumb fuzzing</a></li><li class="chapter-item expanded "><a href="../reverse-engineering/instrumentation.html"><strong aria-hidden="true">1.4.</strong> Instrumentation</a></li><li class="chapter-item expanded "><a href="../reverse-engineering/code-coverage-fuzzing.html"><strong aria-hidden="true">1.5.</strong> Coverage-based fuzzing</a></li><li class="chapter-item expanded "><a href="../reverse-engineering/symbolic-execution.html"><strong aria-hidden="true">1.6.</strong> Symbolic execution</a></li><li class="chapter-item expanded "><a href="../reverse-engineering/binary-diffing.html"><strong aria-hidden="true">1.7.</strong> Binary diffing</a></li><li class="chapter-item expanded "><a href="../reverse-engineering/binary-diffing-tools.html"><strong aria-hidden="true">1.8.</strong> Binary diffing tools</a></li></ol></li><li class="chapter-item expanded "><a href="../common-vulnerabilities/common-vulnerabilities.html"><strong aria-hidden="true">2.</strong> Common vulnerabilities</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../common-vulnerabilities/stack-buffer-overflow.html"><strong aria-hidden="true">2.1.</strong> Stack buffer overflow</a></li><li class="chapter-item expanded "><a href="../common-vulnerabilities/heap-buffer-overflow.html"><strong aria-hidden="true">2.2.</strong> Heap buffer overflow</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../common-vulnerabilities/house-of-force.html"><strong aria-hidden="true">2.2.1.</strong> House of Force</a></li><li class="chapter-item "><a href="../common-vulnerabilities/house-of-orange.html"><strong aria-hidden="true">2.2.2.</strong> House of Orange</a></li><li class="chapter-item "><a href="../common-vulnerabilities/single-byte-overflows.html"><strong aria-hidden="true">2.2.3.</strong> Single byte overflows</a></li></ol></li><li class="chapter-item expanded "><a href="../common-vulnerabilities/use-after-free.html"><strong aria-hidden="true">2.3.</strong> Use after free</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../common-vulnerabilities/fastbin-dup.html"><strong aria-hidden="true">2.3.1.</strong> Fastbin dup</a></li><li class="chapter-item "><a href="../common-vulnerabilities/unsortedbin-attack.html"><strong aria-hidden="true">2.3.2.</strong> Unsortedbin attack</a></li></ol></li><li class="chapter-item expanded "><a href="../common-vulnerabilities/heap-grooming.html"><strong aria-hidden="true">2.4.</strong> Heap grooming</a></li><li class="chapter-item expanded "><a href="../common-vulnerabilities/race-conditions.html"><strong aria-hidden="true">2.5.</strong> Race conditions</a></li></ol></li><li class="chapter-item expanded "><a href="../exploit-primitives/exploit-primitives.html"><strong aria-hidden="true">3.</strong> Exploit primitives</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../exploit-primitives/arbitrary-write-primitives.html"><strong aria-hidden="true">3.1.</strong> Arbitrary write primitives</a></li><li class="chapter-item expanded "><a href="../exploit-primitives/relative-write-primitives.html"><strong aria-hidden="true">3.2.</strong> Relative write primitives</a></li><li class="chapter-item expanded "><a href="../exploit-primitives/arbitrary-read-primitives.html"><strong aria-hidden="true">3.3.</strong> Arbitrary read primitives</a></li><li class="chapter-item expanded "><a href="../exploit-primitives/chaining-primitives.html"><strong aria-hidden="true">3.4.</strong> Chaining primitives</a></li><li class="chapter-item expanded "><a href="../exploit-primitives/escalating-privileges.html" class="active"><strong aria-hidden="true">3.5.</strong> Escalating privileges</a></li></ol></li><li class="chapter-item expanded "><a href="../return-oriented-programming/return-oriented-programming.html"><strong aria-hidden="true">4.</strong> Return oriented programming</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../return-oriented-programming/aslr-nx.html"><strong aria-hidden="true">4.1.</strong> ASLR/NX</a></li><li class="chapter-item expanded "><a href="../return-oriented-programming/finding-gadgets.html"><strong aria-hidden="true">4.2.</strong> Finding gadgets</a></li><li class="chapter-item expanded "><a href="../return-oriented-programming/calling-libc-functions-and-syscalls.html"><strong aria-hidden="true">4.3.</strong> Calling libc functions and syscalls</a></li><li class="chapter-item expanded "><a href="../return-oriented-programming/chaining-gadgets-to-execute-code.html"><strong aria-hidden="true">4.4.</strong> Chaining gadgets to execute code</a></li><li class="chapter-item expanded "><a href="../return-oriented-programming/executing-arbitrary-shellcode.html"><strong aria-hidden="true">4.5.</strong> Executing arbitrary shellcode</a></li></ol></li><li class="chapter-item expanded "><a href="../exploit-mitigations/exploit-mitigations.html"><strong aria-hidden="true">5.</strong> Exploit mitigations</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../exploit-mitigations/aslr.html"><strong aria-hidden="true">5.1.</strong> Address Space Layout Randomization (ASLR)</a></li><li class="chapter-item expanded "><a href="../exploit-mitigations/dep.html"><strong aria-hidden="true">5.2.</strong> Data Execution Prevention (DEP)/NX</a></li><li class="chapter-item expanded "><a href="../exploit-mitigations/position-independent-executables.html"><strong aria-hidden="true">5.3.</strong> Position Independent Executables (PIEs)</a></li><li class="chapter-item expanded "><a href="../exploit-mitigations/exploiting-pies.html"><strong aria-hidden="true">5.4.</strong> Exploiting PIEs</a></li><li class="chapter-item expanded "><a href="../exploit-mitigations/stack-canaries.html"><strong aria-hidden="true">5.5.</strong> Stack canaries</a></li><li class="chapter-item expanded "><a href="../exploit-mitigations/safe-list-unlinking.html"><strong aria-hidden="true">5.6.</strong> Safe list unlinking</a></li></ol></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle"></div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky bordered">
                    <div class="left-buttons">
                        <button id="sidebar-toggle" class="icon-button" type="button" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </button>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu (default)</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">Introduction to the Dark Arts</h1>

                    <div class="right-buttons">
                        <a href="../print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>
                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>
                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script type="text/javascript">
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="escalating-privileges"><a class="header" href="#escalating-privileges">Escalating privileges</a></h1>
<p>We've covered how an arbitrary write primitive can be used to escalate
privileges or execute arbitrary code in a lot of these different discussions,
the Houses covered in our heap exploitation section, for example. In all of
these examples, once the attacker has all the information they need from
previous sensitive information disclosures to build their final payload, these
techniques usually conduct one final, important write to gain control of the
vulnerable process in order to execute arbitrary code. In this section we'll
list some interesting targets that attackers write to to gain control of the
process. This list will not be all-encompassing as I'm sure there are plenty
of other candidates that can be used to hijack the process, these are just ones
that are more popular within the community.</p>
<h3 id="global-offset-table"><a class="header" href="#global-offset-table">Global Offset Table</a></h3>
<p>The GOT is a common location for attackers to target given they have an
arbitrary write primitive. Whenever a program calls functions from linked
libraries, the GOT will be used by the program to either resolve the symbol or
call the symbol stored there. Attackers will commonly overwrite a GOT entry
with the symbol of a different function they want the program to call, usually
ensuring that the next couple of call operations conducted by the program
include the now corrupted GOT entry. While this is a common target for
arbitrary writes to gain arbitrary code execution, keep in mind that <strong>full
RELRO</strong> mitigates this tactic, resolving all entries within the GOT and setting
it to read-only before the program starts. <a href="#references">[2]</a></p>
<h4 id="partial-relro"><a class="header" href="#partial-relro">Partial RELRO</a></h4>
<p>In order to complete our knowledge about the Relocation Read-Only (RELRO)
protection mechanism, Partial RELRO is a security mitigation where the
Global Offset Table is relocated to reside <em>above</em> the <code>.bss</code> section. There
existed previous methods of attacking the GOT where attackers would utilize
a buffer overflow of a global variable contained in the <code>.bss</code> section to
corrupt the GOT - for some reason the <code>.bss</code> used to reside above the GOT
in ELF programs.</p>
<p>Compilers now enforce Partial RELRO by default, placing the GOT above the
<code>.bss</code> in order to mitigate this attack surface. <a href="#references">[7]</a></p>
<h3 id="initialglibc"><a class="header" href="#initialglibc"><code>initial@glibc</code></a></h3>
<p>This write target is pretty cool. The <code>initial</code> data structure in <code>glibc</code> is
a read/writeable segment in memory that is used to contain/register sensitive
information that <code>glibc</code> tracks for the current process. For an attacker, the
more interesting information they would most likely go after are the function
pointers registered by <code>atexit()</code>. My understanding of this data structure and
its use to gain control of the process is derived from <strong>0x00 CTF 2017</strong>'s
challenge, &quot;<strong>Left</strong>&quot;. <a href="#references">[3]</a> In the Left challenge, the program
gives the attacker a <code>glibc</code> leak, one arbitrary read and one arbitrary write
and then calls <code>exit</code> immediately after. The attacker must use this arbitrary
read to leak the mangled pointer of <code>_dl_fini</code> stored in the <code>initial</code> section
of <code>glibc</code>. <code>_dl_fini</code> is a function pointer that is always registered in the
<code>initial</code> section of <code>glibc</code>, and all of the function pointers stored in
<code>initial</code> are unmangled and executed when <code>exit</code> is called. The attacker uses
the exposed, mangled pointer of <code>_dl_fini</code> to derive the secret stored in
Thread Local Storage (TLS) and then mangles a <code>one_gadget</code> address in the
correct manner to forge a valid <code>initial</code> entry. The attacker then uses a
single arbitrary write to overwrite the <code>_dl_fini</code> pointer in <code>initial</code>. Once
the program calls <code>exit</code>, the <code>one_gadget</code> entry in <code>initial</code> will be executed,
allowing the attacker to gain an interactive shell.</p>
<h3 id="_io_list_allglibc"><a class="header" href="#_io_list_allglibc"><code>_IO_list_all@glibc</code></a></h3>
<p>This is an interesting one as well, and its usefulness is showcased in
<a href="../common-vulnerabilities/house-of-orange.html">The House of Orange</a>. In The
House of Orange, the attacker uses the write primitive provided by an
Unsortedbin Attack to write a <code>main_arena</code> address to the <code>_IO_list_all</code> symbol
in <code>glibc</code>. This symbol keeps track of all the open <code>_IO_FILE</code> structures for
the process, and the attacker uses this to kick off some File Stream Oriented
Programming to gain control of the process for arbitrary code execution.
<a href="#references">[5]</a> The attacker forces the process to experience a <code>SIGABRT</code>
rasied by checks in <code>malloc()</code> which leads to <code>glibc</code> attempting to call the
<code>overflow</code> function of all <code>_IO_FILE</code> structures present in the linked list of
<code>_IO_list_all</code>. Because <code>_IO_list_all</code> now points to the <code>main_arena</code>, it
attempts to treat the <code>main_arena</code> as an <code>_IO_FILE</code> structure and attempts to
execute the <code>overflow</code> function registered in its <code>vtable</code>. This obviously fails
but, instead of failing completely, <code>glibc</code> just moves onto the next <code>_IO_FILE</code>
structure pointed to by <code>main_arena</code>'s <code>chain</code> attribute (since <code>glibc</code> assumes
<code>main_arena</code> is an <code>_IO_FILE</code> structure at this point). It just so happens that
this <code>chain</code> attribute points to the <code>smallbin</code>, a location where the attacker
controls the data. Using this, the attacker ensures that a fake, but valid,
<code>_IO_FILE</code> structure resides in this location and fools <code>glibc</code> into calling
<code>overflow</code> from its forged <code>vtable</code>. The attacker ensures that <code>overflow</code> just
ends up being a pointer to <code>system@glibc</code>, and the argument being passed to
this call is the current <code>_IO_FILE</code> struct. The attacker ensures that
<code>&quot;/bin/sh&quot;</code> resides at the first word of bytes in the <code>_IO_FILE</code> struct, thus
fooling the process into executing <code>system(&quot;/bin/sh&quot;)</code>.</p>
<h3 id="__malloc_hookglibc-and-__free_hookglibc"><a class="header" href="#__malloc_hookglibc-and-__free_hookglibc"><code>__malloc_hook@glibc</code> and <code>__free_hook@glibc</code></a></h3>
<p>And, finally, we have our usual suspects, the <code>__malloc_hook</code> and the
<code>__free_hook</code>. These are kinda the easy button of arbitrary write targets
within <code>glibc</code> if we know that our target program is making calls to <code>malloc</code>
and <code>free</code> in the future. As discussed in
<a href="../common-vulnerabilities/house-of-force.html">The House of Force</a>, the
<code>__malloc_hook</code> and the <code>__free_hook</code> are symbols in <code>glibc</code> that were
originally implemented to allow programmers the ability to register functions
that will be executed when calls <code>malloc()</code> or <code>free()</code> are made. The thought
process was to allow programmers the ability to gather memory usage statistics
or to install their own versions of these functions, etc.</p>
<p>Attackers use these hooks to redirect program execution with just one arbitrary
write, and they usually overwrite these locations with the address of a
<code>one_gadget</code> or the symbol of <code>system()</code>. It's not outside the realm of
possibility, however, that they could use these hooks to pivot to the location
of a <code>ROP</code> chain which could possibly lead to the execution of more complex
shellcode.</p>
<h3 id="honorable-mention-_dl_open_hookglibc"><a class="header" href="#honorable-mention-_dl_open_hookglibc">Honorable mention: <code>_dl_open_hook@glibc</code></a></h3>
<p>I won't go into too much detail with this one seeing as we've covered so many
other options already, but I recently just learned about this technique which
surprisingly doesn't have a lot of coverage on the internet. In
POCORGTFO 2018 <a href="#references">[6]</a>, an author covers what they call the
&quot;House of Fun&quot;, a <code>frontlink</code> attack in <code>malloc()</code> that people assumed was
mitigated but actually went unpatched until <code>glibc 2.30</code>. With the arbitrary
write that they gain through this technique, the attackers target
<code>_dl_open_hook</code> which is a hook where programmers can register a function
pointer to be called when <code>dlopen()</code> is called by the program. A little known
fact is that <code>malloc_printerr</code> when causes a <code>SIGABRT</code> and the program attempts
to dump the memory mapping of the process, it needs to call <code>dlopen</code> on
<code>libgcc_s.so.1</code> in order to access the <code>__backtrace</code> function. With this in
mind, the attackers write a <code>one_gadget</code> to <code>_dl_open_hook-&gt;dlopen_mode</code> and
force <code>malloc()</code> to encounter corrupted heap metadata, causing it to call
<code>malloc_printerr</code> which leads to <code>dlopen()</code> which leads to the program
executing <code>sys_execve(&quot;/bin/sh&quot;)</code>.</p>
<h2 id="conclusion"><a class="header" href="#conclusion">Conclusion</a></h2>
<p>As we can see, viable write targets to gain arbitrary code execution within a
process are aplenty. It's up to the attacker to ensure they understand what
conditions need to be present in order to get reliable code execution - there's
also some creativity required.</p>
<h2 id="references"><a class="header" href="#references">References</a></h2>
<ol>
<li><a href="../common-vulnerabilities/house-of-force.html">The House of Force</a></li>
<li><a href="https://ctf101.org/binary-exploitation/relocation-read-only/">https://ctf101.org/binary-exploitation/relocation-read-only/</a></li>
<li><a href="https://ctftime.org/writeup/8385">https://ctftime.org/writeup/8385</a></li>
<li><a href="../common-vulnerabilities/house-of-orange.html">The House of Orange</a></li>
<li><a href="https://ctf-wiki.github.io/ctf-wiki/pwn/linux/io_file/fsop/">https://ctf-wiki.github.io/ctf-wiki/pwn/linux/io_file/fsop/</a></li>
<li><a href="https://www.alchemistowl.org/pocorgtfo/pocorgtfo18.pdf">https://www.alchemistowl.org/pocorgtfo/pocorgtfo18.pdf</a></li>
<li><a href="https://ctf101.org/binary-exploitation/relocation-read-only/">https://ctf101.org/binary-exploitation/relocation-read-only/</a></li>
</ol>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="../exploit-primitives/chaining-primitives.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>
                            <a rel="next" href="../return-oriented-programming/return-oriented-programming.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>
                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="../exploit-primitives/chaining-primitives.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>
                    <a rel="next" href="../return-oriented-programming/return-oriented-programming.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
            </nav>

        </div>

        <!-- Livereload script (if served using the cli tool) -->
        <script type="text/javascript">
            var socket = new WebSocket("ws://localhost:9000/__livereload");
            socket.onmessage = function (event) {
                if (event.data === "reload") {
                    socket.close();
                    location.reload();
                }
            };

            window.onbeforeunload = function() {
                socket.close();
            }
        </script>
        <script type="text/javascript">
            window.playground_copyable = true;
        </script>
        <script src="../elasticlunr.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="../mark.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="../searcher.js" type="text/javascript" charset="utf-8"></script>
        <script src="../clipboard.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="../highlight.js" type="text/javascript" charset="utf-8"></script>
        <script src="../book.js" type="text/javascript" charset="utf-8"></script>

        <!-- Custom JS scripts -->
    </body>
</html>
